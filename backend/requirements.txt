# =============================================================================
# Savitara Backend — Python dependencies
# Last security audit: 2026-02-26 (pip-audit)
# To re-audit: pip-audit --requirement requirements.txt --format=columns
# =============================================================================

# --- FastAPI Core -----------------------------------------------------------
# fastapi>=0.115.0 fixes PYSEC-2024-38 (ReDoS via python-multipart)
fastapi>=0.115.0,<0.117.0
uvicorn[standard]>=0.27.0,<0.35.0
pydantic>=2.5.0,<3.0.0
pydantic-settings>=2.1.0,<3.0.0
# python-multipart>=0.0.22 fixes CVE-2024-53981, PYSEC-2024-38, CVE-2026-24486
python-multipart>=0.0.22

# --- Database ----------------------------------------------------------------
# motor>=3.6.0 is required for pymongo>=4.6.0 compatibility
motor>=3.6.0,<4.0.0
# pymongo>=4.6.3 fixes CVE-2024-5629 (BSON unicode crash)
pymongo>=4.6.3,<5.0.0

# --- Authentication & Security ----------------------------------------------
# python-jose>=3.4.0 fixes PYSEC-2024-232, PYSEC-2024-233 (algorithm confusion)
# Note: transitive dep ecdsa 0.19.1 has CVE-2024-23342 (timing side-channel)
#   — no upstream fix available; mitigated by server-side token validation
python-jose[cryptography]>=3.4.0
passlib[bcrypt]>=1.7.4
google-auth>=2.35.0
google-auth-oauthlib>=1.2.0
google-auth-httplib2>=0.2.0
# cryptography>=46.0.5 fixes CVE-2024-0727, CVE-2023-50782, PYSEC-2024-225,
#   GHSA-h4gh-qq45-vh27, CVE-2026-26007
cryptography>=46.0.5

# --- Payment & Notifications ------------------------------------------------
razorpay>=1.4.1
firebase-admin>=6.4.0

# --- Utilities --------------------------------------------------------------
python-dateutil>=2.8.2
pytz>=2024.1
shortuuid>=1.0.11
pillow>=10.3.0

# --- Panchanga & Hindu Calendar ---------------------------------------------
ephem>=4.1.5

# --- Validation & Serialization ---------------------------------------------
email-validator>=2.3.0
phonenumbers>=8.13.27

# --- HTTP & Networking -------------------------------------------------------
# httpx>=0.27 is compatible with fastapi 0.115 / starlette 0.40
httpx>=0.27.0,<0.30.0
aiohttp>=3.10.0
websockets>=12.0
aiofiles>=23.2.1
boto3>=1.34.0

# --- Rate Limiting -----------------------------------------------------------
slowapi>=0.1.9

# --- Voice / SMS -------------------------------------------------------------
twilio>=8.10.0

# --- Development & Testing (not installed in production Docker image) --------
pytest>=8.0.0
pytest-asyncio>=0.23.3
pytest-cov>=4.1.0
# black>=24.3.0 fixes PYSEC-2024-48 (DoS on crafted input)
black>=24.8.0
mypy>=1.8.0
pip-audit>=2.7.0

# --- Monitoring & Logging ---------------------------------------------------
# sentry-sdk>=2.8.0 fixes CVE-2024-40647 (env var leakage)
sentry-sdk[fastapi]>=2.8.0
python-json-logger>=2.0.7

# --- Caching -----------------------------------------------------------------
redis[hiredis]>=5.0.1

# --- Data Analysis & ML (recommendations) -----------------------------------
numpy>=1.26.0
scipy>=1.11.0

# --- Search & Indexing -------------------------------------------------------
elasticsearch>=8.11.1
elasticsearch[async]>=8.11.1

# Load Testing
locust==2.20.0

# Environment
python-dotenv==1.0.0
setuptools<81  # Required by razorpay 1.4.1 (pkg_resources)
